rule Multi_Key_XOR
{
	meta:
		author = "Ashley Shen"
		description = "this rule try to match Multi_Key_XOR function use by NK"
		date = "2017/08/20"

	strings:
		$code1 = { 8A 1C 37 32 DA 32 D8 32 D9 88 1E 8A D8 32 D9 22 DA 8A D0 22 D1 32 DA 8B 54 24 14 8A CB 8D 1C D5 00 00 00 00 33 DA 81 E3 F8 07 00 00 C1 E3 14 C1 EA 08 0B D3 8D 1C 00 33 D8 C1 E3 04 33 D8 8B E8 83 E3 80 C1 E5 07 33 DD C1 E3 11 C1 E8 08 0B C3 46 }

		$code2 = { 8A 1C 37 32 DA 32 D8 32 D9 88 1E 8A D8 32 D9 22 DA 8A D0 22 D1 32 DA 8B 54 [2] 8A CB 8D 1C [5] 33 DA 81 E3 F8 07 00 00 C1 E3 14 C1 EA 08 0B D3 8D 1C 00 33 D8 C1 E3 04 33 D8 8B E8 83 E3 80 C1 E5 07 33 DD C1 E3 11 C1 E8 08 0B C3 46 }
		
		$decode1 = { 8A 1C 37 32 DA 32 D8 32 D9 88 1E 8A D8 32 D9 22 DA 8B 55 [1] 8D 3C [5] 33 FA 81 E7 F8 07 00 00 C1 E7 14 C1 EA 08 0B D7 8D 3C 00 33 F8 22 C8 C1 E7 04 33 F8 32 CB 8B D8 83 E7 80 C1 E3 07 33 FB C1 E7 11 C1 E8 08 0B C7 46 }

		$decode2 = { 8A 1C 37 32 DA 32 D8 32 D9 88 1E 8A D8 32 D9 22 DA 8B 55 FC 8D 3C D5 00 00 00 00 33 FA 81 E7 F8 07 00 00 C1 E7 14 C1 EA 08 0B D7 8D 3C 00 33 F8 22 C8 C1 E7 04 33 F8 32 CB 8B D8 83 E7 80 C1 E3 07 33 FB C1 E7 11 C1 E8 08 0B C7 46 }
		
	condition:
		any of ($decode*) or any of ($code*)
		
}